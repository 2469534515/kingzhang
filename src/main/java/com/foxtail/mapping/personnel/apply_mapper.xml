<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.foxtail.dao.mybatis.personnel.ApplyDao">
	
	<sql id="base_column">
		a.*
	</sql>

	  
	<select id="findForPage" resultType="com.foxtail.model.personnel.Apply" >
  		select  <include refid="base_column" />,b.name uname,b.identifier from man_apply a left join man_emp b
  		on a.uid = b.id
  		 WHERE uid = #{ft.uid}
  		<if test="ft.applytype != null ">AND a.type = #{ ft.applytype }</if>
  		ORDER BY a.createtime DESC
  	</select>
  
		
	<select id="getById" resultType="com.foxtail.model.personnel.Apply" >
  		select  <include refid="base_column" /> from man_apply a where a.id=#{id}
  	</select> 

	
	
	<update id="update" >
	   UPDATE man_apply
		<set>
		<if test="model.starttime != null ">starttime=#{ model.starttime },</if>
		<if test="model.endtime != null ">endtime=#{ model.endtime },</if>
		<if test="model.info != null ">info=#{ model.info },</if>
		<if test="model.leave_type != null ">leave_type = #{ model.leave_type },</if>
		<if test="model.state != null ">state = #{ model.state },</if>
		</set>
		 WHERE id=#{model.id}
	</update>

	 <!-- 根据对象主键更新 -->
  	<insert id="save"  >
     INSERT INTO man_apply(uid, type,leave_type, starttime, endtime, info,createtime) VALUES(#{ model.uid },#{ model.type },#{ model.leave_type },#{ model.starttime },#{ model.endtime },#{ model.info },unix_timestamp(now())*1000)
     </insert>
	
  	
  
</mapper>   
